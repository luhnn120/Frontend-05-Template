学习笔记
# HTML parse
parser 接受HTML文本作为参数，返回一个dom树

## HTML标签处理
  * 开始标签
  * 结束标签
  * 自封闭标签
## 创建元素 
  * 在状态迁移的同时处理逻辑，创建元素
  * 在标签结束的时候提交元素token
## 处理属性
  * 属性值分为单引号、双引号、无引号的三种写法。
  * 在属性结束时，将属性加到标签Token上
## 构建HTML树
  * 使用栈来构建DOM树
  * 遇到开始标签时入栈，结束标签时出栈
  * 自封闭标签入栈后立刻出栈
  * 任何元素的父元素为入栈时的栈顶元素
### 文本节点
  * 通过文本节点不断获取文本内容
  * 在遇到开始标签和结束标签时，重置文本节点
## css computing
  * 遇到style标签时，收集css规则
  * 通过调用css paser生产css ast
  * 分析css规则的格式
### 添加css调用
  * css的调用是越早进行越好，因此在startTag标签入栈时，我们就进行css计算
  * 理论上分析一个元素时，所有css的规则应该收集完毕的
  * 但是在真实的浏览器里，会要到body中存在style标签的情况，此时要重新计算css
#### 获取父元素
  * 在css compute过程中，我们要知道元素所有的父元素才能进行css规则的匹配
  * 我们会反转stack中元素，从当前元素逐层的获取父元素
  * 因为我们获取到的是当前元素，因此我们计算匹配顺序是从内往外的
#### 选择器匹配
  * 选择器从当前元素向外排列
  * 复杂选择器拆分成针对单个元素的选择器，循环匹配父元素
  * 一旦匹配，将选择器应用到元素上，形成computed style
#### specificity
  * css 规则根据specificity和后来优先规则进行覆盖
  * specificity是一个四元组，越左边权重越高
  * specificity是由所有简单选择器相加得到的
  